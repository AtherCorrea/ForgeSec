# 🧪 Test 01 – Nmap Scan Against Windows Server

**Date:** 2025-06-20\
**Author:** Ather Correa\
**Monitored Tool:** Suricata IDS\
**Objective:** Validate detection of port scanning and fingerprinting using Nmap

---

## 🌟 Test Scenario

| Item                | Details                       |
| ------------------- | ----------------------------- |
| Attacker            | Kali Linux                    |
| Target              | Windows Server 2022           |
| IDS/Firewall        | pfSense + Suricata (IDS mode) |
| Monitored Interface | LAN (192.168.100.0/24)        |
| Attacker IP         | Nat IP                        |
| Target IP           | 192.168.100.10                |

---

## 🛠️ Executed Command

```bash
nmap -A -T4 -sV -O --script vuln 192.168.100.10
```

**Command Description:**

- `-A` = enables advanced detection (OS, services, NSE scripts)
- `-T4` = aggressive timing
- `-sV` = version detection
- `-O` = OS detection
- `--script vuln` = runs NSE scripts for known vulnerabilities

---

## 🚨 Alerts Generated (Suricata)

| Category  | SID     | Alert Description                           |
| --------- | ------- | ------------------------------------------- |
| ET SCAN   | 2010937 | Nmap Scripting Engine User-Agent Detected   |

> 🔍 **Note:** These alerts only appeared after manually enabling rule categories on the `WAN` interface in Suricata.

---

## 📄 Generated Files

| File Name             | Description                                    |
| --------------------- | ---------------------------------------------- |
| `eve.json`            | Raw log generated by Suricata                  |
| `screenshot.png`      | Screenshot of the alert in Suricata (optional) |

---

## 📌 Observations

- Suricata had rules downloaded but **not enabled** initially
- After enabling the `ET Open Scan` category, alerts began appearing properly
- Kali was in the WAN, so traffic was monitored correctly by the IDS

---

## ✅ Conclusion

The test validated that:

- Suricata is **capturing WAN traffic correctly**
- Rules must be **explicitly enabled** per interface
- The Nmap `-A` command generates sufficient alert data to simulate malicious behavior

---
